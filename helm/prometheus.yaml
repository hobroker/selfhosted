replicaCount: 1

image:
  repository: prom/prometheus
  tag: v2.33.3

services:
  - type: LoadBalancer
    ports:
      - protocol: TCP
        port: 9090

volumes:
  - name: prometheus-data
    hostPath:
      path: "/appdata/k3s/prometheus/data"
  - name: prometheus-configmap
    configMap:
      name: prometheus-configmap

volumeMounts:
  - name: prometheus-data
    mountPath: "/prometheus"
  - name: prometheus-configmap
    subPath: prometheus.yml
    mountPath: "/etc/prometheus/prometheus.yml"

configmaps:
  prometheus-configmap:
    prometheus.yml: |-
      global:
        evaluation_interval: 60s
        scrape_interval: 15s
      scrape_configs:
        - job_name: prometheus
          static_configs:
            - targets:
                - localhost:9090
        - job_name: home_weather
          scrape_interval: 10s
          static_configs:
            - targets:
                - 192.168.29.54:5000
        - job_name: grafana
          static_configs:
            - targets:
                - grafana:5000
        - job_name: traefik
          static_configs:
            - targets:
                - traefik:9100
        - job_name: wakatime
          static_configs:
            - targets:
                - wakatime-exporter:9212
        - job_name: rclone
          static_configs:
            - targets:
                - 192.168.29.242:5572
          basic_auth:
            username: 'admin'
            password: 'admin'
